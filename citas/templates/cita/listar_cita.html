{% extends 'login/vista_principal.html' %}
{% block titulo %}
Listado de Citas
{% endblock titulo %}
{% load static %}
{% block extra_css %}
<link rel="stylesheet" href="/static/css/lib/datatable/dataTables.bootstrap.min.css"></link>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.css"></link>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/css/bootstrap.css"></link>
<link rel="stylesheet" href="/static/fullcalendar/lib/main.css"
></link>
{% endblock extra_css %}
{% block body %}
<div class="col-auto mb-4 mb-md-0">
    <p class="pt-2">
        <strong>Listado de Citas</strong>
    </p>
</div>
<div class="card-footer">
    <button type="button" class="btn btn-primary btn-flat"onclick="abrir_modal_creacion('{% url 'crear_cita' %}')"><i class="fas fa-plus"></i></i> Nuevo
    </button>
</div>
<div id="calendar" class="card-block" style="padding: 20px;"></div>
{% endblock body %}
{% block extrajs %}

<script src="/static/js/lib/data-table/dataTables.bootstrap.min.js"></script>
<script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
<script src="/static/fullcalendar/lib/main.js"></script>
<script src="/static/fullcalendar/lib/locales-all.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function(){
        var calendarUI = document.getElementById('calendar');
        var calendar = new FullCalendar.Calendar(calendarUI,{
            headerToolbar: {
                left: 'prev,next today',
                center: "title"
            },
            events: [
                {% for Citas  in object_list %}
                    {
                        title : "{{Citas.paciente}}",
                        doctor : "{{Citas.doctor}}",
                        tratamiento : "{{Citas.tratamiento}}",
                        start : "{{Citas.fecha| date:'Y-m-d'}}",
                        end : "{{Citas.fecha| date:'Y-m-d'}}",
                        // url: 'http://google.com/'
                    },
                    {% endfor %}

                ]
         
        });
        calendar.render();
        calendar.setOption('locale','es');
 
    });
</script>
<script type="text/javascript">
    var $ = jQuery.noConflict();
    function abrir_modal_creacion(url) {
        $('#creacion').load(url, function () {
            $(this).modal('show')
        });
    }
    function abrir_modal_edicion(url) {
        $('#edicion').load(url, function () {
            $(this).modal('show')
        });
    }
    function eliminarpaciente(id) {
        Swal.fire({
            "title": "¿Estás seguro?",
            "text": "Una vez eliminado, no se puede restaurar",
            "icon": "warning",
            "showCancelButton": true,
            "confirmButtonColor": '#3085d6',
            "cancelButtonColor": '#d33',
            "confirmButtonText": 'Yes, delete it!'
        })
            .then(function (result) {
                if (result.isConfirmed) {
                    window.location.href = "eliminar_paciente" + id + "/"
                }
            })
    }

</script>

{% endblock extrajs %}
